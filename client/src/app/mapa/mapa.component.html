<h1 class="app-titulo">Real Time Map</h1>
<hr>

<div class="map-wrapper">
  <div class="connection-dot" [class.connected]="wsService.socketStatus"></div>
  <div #map id="map"></div>
</div>

<div class="mi-nombre">
  <label>Your name:</label>
  <div class="mi-nombre-input-wrapper">
    <input type="text"
          [(ngModel)]="miNombre"
          (keyup.enter)="cambiarNombre()"
          placeholder="Enter your name"
          maxlength="30">
    <button class="mi-nombre-btn" (click)="cambiarNombre()">OK</button>
  </div>
</div>

<div class="sesiones">
  <h3>Connected sessions <span class="sesiones-count">{{ usuarios.length }}</span></h3>
  <div class="sesiones-lista">
    <div class="sesion-card" *ngFor="let usuario of usuarios" (click)="abrirModalUbicacion(usuario)">
      <span class="sesion-icono">ðŸ‘¤</span>
      <span class="sesion-nombre">{{ usuario.nombre === 'sin-nombre' ? 'Anonymous' : usuario.nombre }}</span>
      <span class="sesion-ubicacion" *ngIf="usuario.ciudad">â€” {{ usuario.ciudad }}, {{ usuario.estado }}, {{ usuario.pais }}</span>
    </div>
    <p class="sesiones-vacio" *ngIf="usuarios.length === 0">No connected sessions.</p>
  </div>
</div>

<div class="modal-overlay" *ngIf="usuarioSeleccionado" (click)="cerrarModal()">
  <div class="modal-contenido" (click)="$event.stopPropagation()">
    <button class="modal-cerrar" (click)="cerrarModal()">&times;</button>
    <h4 class="modal-titulo">{{ usuarioSeleccionado.nombre === 'sin-nombre' ? 'Anonymous' : usuarioSeleccionado.nombre }}</h4>
    <div #mapModal class="modal-mapa"></div>
  </div>
</div>
